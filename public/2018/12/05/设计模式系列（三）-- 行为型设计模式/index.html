<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Tech Team of Zhufaner Inc."><meta name="description" conauthortent="住范儿技术团队博客"><link rel="alternative" href="/atom.xml" title="住范儿技术团队" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><title>设计模式系列（三）-- 行为型设计模式 - 住范儿技术团队</title><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script src="/js/jquery-3.1.1.min.js"></script><script src="/js/fancybox/jquery.fancybox.min.js"></script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create', 'UA-99090733-1', 'auto');ga('send', 'pageview');
</script><!-- Hotjar Tracking Code for ochukai.me --></head><body style="opacity:0"><header class="head"><h1 class="head-title u-fl"><a href="/">住范儿技术团队</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="/archives" class="head-nav__link">目录</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head">  <time datetime="2018-12-05T09:37:10.000Z" class="post__time">十二月 5, 2018<a href="https://github.com/hydznsqk" class="author">作者：侯亚东</a></time><h1 class="post__title">设计模式系列（三）-- 行为型设计模式</h1><div class="post__main echo"><p>#前言<br>Android设计模式,共分为三大类,分别是:创建型模式,行为型模式和结构型模式。接第二篇结构型文章之后的第三篇,本篇分享的是所有的行为型设计模式。如果想单独看某一个设计模式,可以点击<a href="https://www.jianshu.com/u/f07649312c75" target="_blank" rel="noopener">信仰年輕的设计模式</a>。</p>
<p></p><h1 align="center">设计模式（十四）– 模板方法模式</h1><p></p>
<p><hr></p>
<blockquote>
<p>源代码<br><a href="https://github.com/hydznsqk/MyDesignPattern" target="_blank" rel="noopener">GitHub源代码</a></p>
</blockquote>
<h2 id="1-本文目标"><a href="#1-本文目标" class="headerlink" title="1.本文目标"></a>1.本文目标</h2><p>本文目标是为了让大家认识并理解模板方法模式</p>
<h2 id="2-基本套路"><a href="#2-基本套路" class="headerlink" title="2.基本套路"></a>2.基本套路</h2><p>定义:定义了一个算法的骨架,并允许子类为一个或多个步骤提供实现</p>
<p>类型:行为型</p>
<p>选择关键点:算法骨架是否牢固</p>
<p>设计原则:破坏里氏替换，体现功能复用</p>
<p>使用概率:80%</p>
<p>难度系数:中低</p>
<h2 id="3-适用场景"><a href="#3-适用场景" class="headerlink" title="3.适用场景"></a>3.适用场景</h2><p>1.一次性实现一个算法的不变的部分,并将可变的行为留给子类来实现</p>
<p>2.各子类中公共的行为被提取出来并集中到一个公共父类中,从而避免代码重复</p>
<h2 id="4-使用步骤"><a href="#4-使用步骤" class="headerlink" title="4.使用步骤"></a>4.使用步骤</h2><p>用栗子能更好的说明问题,请继续往下看</p>
<h2 id="5-举个栗子"><a href="#5-举个栗子" class="headerlink" title="5.举个栗子"></a>5.举个栗子</h2><p>我们用具体的代码去更好的理解这个设计模式</p>
<h4 id="5-1栗子说明"><a href="#5-1栗子说明" class="headerlink" title="5.1栗子说明"></a>5.1栗子说明</h4><ul>
<li>背景:录制视频都需要编写ppt,制作视频和写手记,然后用这个模板制作不同的课程</li>
<li>目的:通过模板方法去制作</li>
</ul>
<h4 id="5-2使用步骤"><a href="#5-2使用步骤" class="headerlink" title="5.2使用步骤"></a>5.2使用步骤</h4><p>实现代码如下:</p>
<p><strong>步骤1.</strong>创建课程抽象类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ACourse</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//模板方法 制作课程</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">makeCourse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.makePPT();</span><br><span class="line">        <span class="keyword">this</span>.makeVideo();</span><br><span class="line">        <span class="keyword">if</span>(needWriteArticle())&#123;</span><br><span class="line">            <span class="keyword">this</span>.writeArticle();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.packageCourse();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">makePPT</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"制作PPT"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">makeVideo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"制作视频"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">writeArticle</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"编写手记"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//钩子方法</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">needWriteArticle</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//包装课程</span></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">packageCourse</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤2.</strong>创建设计模式课程,继承抽象课程类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DesignPatternCourse</span> <span class="keyword">extends</span> <span class="title">ACourse</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">packageCourse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"提供课程Java源代码"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">needWriteArticle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤3.</strong>创建前端课程,继承抽象课程类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FECourse</span> <span class="keyword">extends</span> <span class="title">ACourse</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> needWriteArticleFlag = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">packageCourse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"提供课程的前端代码"</span>);</span><br><span class="line">        System.out.println(<span class="string">"提供课程的图片等多媒体素材"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FECourse</span><span class="params">(<span class="keyword">boolean</span> needWriteArticleFlag)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.needWriteArticleFlag = needWriteArticleFlag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">needWriteArticle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.needWriteArticleFlag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤4.</strong> 测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       System.out.println(<span class="string">"设计模式课程start---"</span>);</span><br><span class="line">       ACourse designPatternCourse = <span class="keyword">new</span> DesignPatternCourse();</span><br><span class="line">       designPatternCourse.makeCourse();</span><br><span class="line">       System.out.println(<span class="string">"设计模式课程end---"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"前端课程start---"</span>);</span><br><span class="line">       ACourse feCourse = <span class="keyword">new</span> FECourse(<span class="keyword">false</span>);</span><br><span class="line">       feCourse.makeCourse();</span><br><span class="line">       System.out.println(<span class="string">"前端课程end---"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-优点"><a href="#6-优点" class="headerlink" title="6.优点"></a>6.优点</h2><ul>
<li>提高复用性</li>
<li>提高扩展性</li>
<li>符合开闭原则</li>
</ul>
<h2 id="7-缺点"><a href="#7-缺点" class="headerlink" title="7.缺点"></a>7.缺点</h2><ul>
<li>类数目的增加</li>
<li>增加了系统实现的复杂度</li>
<li>继承关系自身缺点,如果父类添加新的抽象方法,所有的子类都要改一遍</li>
</ul>
<p></p><h1 align="center">设计模式（十五）– 迭代器模式</h1><p></p>
<p><hr></p>
<blockquote>
<p>源代码<br><a href="https://github.com/hydznsqk/MyDesignPattern" target="_blank" rel="noopener">GitHub源代码</a></p>
</blockquote>
<h2 id="1-本文目标-1"><a href="#1-本文目标-1" class="headerlink" title="1.本文目标"></a>1.本文目标</h2><p>本文目标是为了让大家认识并理解迭代器模式</p>
<h2 id="2-基本套路-1"><a href="#2-基本套路-1" class="headerlink" title="2.基本套路"></a>2.基本套路</h2><p>定义:提供一种方法,顺序访问一个集合对象中的各个元素,而又不暴露该对象的内部表示</p>
<p>类型:行为型</p>
<p>选择关键点:客户端是否关心遍历的次序</p>
<p>设计原则:遵循迪米特</p>
<p>使用概率:99.99999%</p>
<p>难度系数:中</p>
<h2 id="3-适用场景-1"><a href="#3-适用场景-1" class="headerlink" title="3.适用场景"></a>3.适用场景</h2><p>1.访问一个集合对象的内容而无需暴露它的内部表示</p>
<p>2.为遍历不同的集合结构提供一个统一的接口</p>
<h2 id="4-使用步骤-1"><a href="#4-使用步骤-1" class="headerlink" title="4.使用步骤"></a>4.使用步骤</h2><p>用栗子能更好的说明问题,请继续往下看</p>
<h2 id="5-举个栗子-1"><a href="#5-举个栗子-1" class="headerlink" title="5.举个栗子"></a>5.举个栗子</h2><p>我们用具体的代码去更好的理解这个设计模式</p>
<h4 id="5-1栗子说明-1"><a href="#5-1栗子说明-1" class="headerlink" title="5.1栗子说明"></a>5.1栗子说明</h4><ul>
<li>背景:网上有很多学习Java的课程</li>
<li>目的:然后想通过迭代器模式去进行遍历并打印</li>
</ul>
<h4 id="5-2使用步骤-1"><a href="#5-2使用步骤-1" class="headerlink" title="5.2使用步骤"></a>5.2使用步骤</h4><p>实现代码如下:</p>
<p><strong>步骤1.</strong>创建课程的实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Course</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Course</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤2.</strong>创建课程的集合 接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CourseAggregate</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加课程</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addCourse</span><span class="params">(Course course)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除课程</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">removeCourse</span><span class="params">(Course course)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 课程迭代器</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">CourseIterator <span class="title">getCourseIterator</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤3.</strong>创建课程的集合 的实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CourseAggregateImpl</span> <span class="keyword">implements</span> <span class="title">CourseAggregate</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List courseList;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CourseAggregateImpl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courseList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCourse</span><span class="params">(Course course)</span> </span>&#123;</span><br><span class="line">        courseList.add(course);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeCourse</span><span class="params">(Course course)</span> </span>&#123;</span><br><span class="line">        courseList.remove(course);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CourseIterator <span class="title">getCourseIterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CourseIteratorImpl(courseList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤4.</strong> 课程迭代器的接口类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CourseIterator</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取下个一个课程</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Course <span class="title">nextCourse</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是不是下一个课程</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isLastCourse</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤5.</strong> 课程迭代器的实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CourseIteratorImpl</span> <span class="keyword">implements</span> <span class="title">CourseIterator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List courseList;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> position;</span><br><span class="line">    <span class="keyword">private</span> Course course;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CourseIteratorImpl</span><span class="params">(List courseList)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courseList=courseList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Course <span class="title">nextCourse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"返回课程,位置是: "</span>+position);</span><br><span class="line">        course=(Course)courseList.get(position);</span><br><span class="line">        position++;</span><br><span class="line">        <span class="keyword">return</span> course;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLastCourse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(position&lt; courseList.size())&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤6.</strong> 测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//创建3个课程</span></span><br><span class="line">       Course course1 = <span class="keyword">new</span> Course(<span class="string">"Java基础"</span>);</span><br><span class="line">       Course course2 = <span class="keyword">new</span> Course(<span class="string">"Android基础"</span>);</span><br><span class="line">       Course course3 = <span class="keyword">new</span> Course(<span class="string">"Java设计模式"</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//把这3个课程添加到课程集合类中</span></span><br><span class="line">       CourseAggregate courseAggregate = <span class="keyword">new</span> CourseAggregateImpl();</span><br><span class="line">       courseAggregate.addCourse(course1);</span><br><span class="line">       courseAggregate.addCourse(course2);</span><br><span class="line">       courseAggregate.addCourse(course3);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"-----课程列表-----"</span>);</span><br><span class="line">       printCourses(courseAggregate);</span><br><span class="line">       <span class="comment">//删除课程3(Java设计模式)</span></span><br><span class="line">       courseAggregate.removeCourse(course3);</span><br><span class="line">       System.out.println(<span class="string">"-----删除操作之后的课程列表-----"</span>);</span><br><span class="line">       printCourses(courseAggregate);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 遍历迭代器并打印课程的名字</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printCourses</span><span class="params">(CourseAggregate courseAggregate)</span></span>&#123;</span><br><span class="line">       CourseIterator courseIterator= courseAggregate.getCourseIterator();</span><br><span class="line">       <span class="keyword">while</span>(!courseIterator.isLastCourse())&#123;</span><br><span class="line">           Course course=courseIterator.nextCourse();</span><br><span class="line">           System.out.println(course.getName());</span><br><span class="line">      &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-优点-1"><a href="#6-优点-1" class="headerlink" title="6.优点"></a>6.优点</h2><ul>
<li>分离了集合对象的遍历行为</li>
</ul>
<h2 id="7-缺点-1"><a href="#7-缺点-1" class="headerlink" title="7.缺点"></a>7.缺点</h2><ul>
<li>类的个数成对增加</li>
</ul>
<p></p><h1 align="center">设计模式（十六）– 策略模式</h1><p></p>
<p><hr></p>
<blockquote>
<p>源代码<br><a href="https://github.com/hydznsqk/MyDesignPattern" target="_blank" rel="noopener">GitHub源代码</a></p>
</blockquote>
<h2 id="1-本文目标-2"><a href="#1-本文目标-2" class="headerlink" title="1.本文目标"></a>1.本文目标</h2><p>本文目标是为了让大家认识并理解策略模式</p>
<h2 id="2-基本套路-2"><a href="#2-基本套路-2" class="headerlink" title="2.基本套路"></a>2.基本套路</h2><p>定义:定义了算法家族,分别封装起来,让它们之间可以互相替换,此模式让算法的变化不会影响到使用算法的用户</p>
<p>类型:行为型</p>
<p>选择关键点:客户端是否依赖于某一个或若干个具体的策略</p>
<p>设计原则:遵循单一职责、依赖倒置、迪米特、开闭原则</p>
<p>使用概率:60%</p>
<p>难度系数:中</p>
<h2 id="3-适用场景-2"><a href="#3-适用场景-2" class="headerlink" title="3.适用场景"></a>3.适用场景</h2><p>1.系统有很多类,而它们的区别仅仅在于它们的行为不同</p>
<p>2.一个系统需要动态的在几种算法中选择一种</p>
<h2 id="4-使用步骤-2"><a href="#4-使用步骤-2" class="headerlink" title="4.使用步骤"></a>4.使用步骤</h2><p>用栗子能更好的说明问题,请继续往下看</p>
<h2 id="5-举个栗子-2"><a href="#5-举个栗子-2" class="headerlink" title="5.举个栗子"></a>5.举个栗子</h2><p>我们用具体的代码去更好的理解这个设计模式</p>
<h4 id="5-1栗子说明-2"><a href="#5-1栗子说明-2" class="headerlink" title="5.1栗子说明"></a>5.1栗子说明</h4><ul>
<li>背景:鸭子有很多种类,然后有能飞的和不能飞的</li>
<li>目的:用策略模式实现鸭子的行为</li>
</ul>
<h4 id="5-2使用步骤-2"><a href="#5-2使用步骤-2" class="headerlink" title="5.2使用步骤"></a>5.2使用步骤</h4><p>实现代码如下:</p>
<p><strong>步骤1.</strong>创建飞行的行为接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">FlyBehaviour</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤2.</strong>创建能够飞行的行为接口实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyImp</span> <span class="keyword">implements</span> <span class="title">FlyBehaviour</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"能够飞行~~~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤3.</strong>创建不能够飞行的行为接口实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyNoWayImp</span> <span class="keyword">implements</span> <span class="title">FlyBehaviour</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"不能飞,飞不起来~~~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤4.</strong> 创建父类 Duck</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseDuck</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这个是接口,让子类去实现这个接口</span></span><br><span class="line">    FlyBehaviour mFlyBehaviour;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mFlyBehaviour.fly();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置可以飞行的行为接口实现类</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">setFlyBehaviour</span><span class="params">(FlyImp flyImp)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mFlyBehaviour=flyImp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置不可以飞行的行为接口实现类</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span>  <span class="title">setFlyNoWayBehaviour</span><span class="params">(FlyNoWayImp flyNoWayBehaviour)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mFlyBehaviour=flyNoWayBehaviour;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤5.</strong> 创建北京烤鸭,飞不起来</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeiJingDuck</span> <span class="keyword">extends</span> <span class="title">BaseDuck</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BeiJingDuck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mFlyBehaviour = <span class="keyword">new</span> FlyNoWayImp();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(BeiJingDuck.class.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤6.</strong> 创建绿头鸭,能够飞行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GreenHeadDuck</span> <span class="keyword">extends</span> <span class="title">BaseDuck</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GreenHeadDuck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mFlyBehaviour = <span class="keyword">new</span> FlyImp();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(GreenHeadDuck.class.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤7.</strong> 测试,上面的一系列操作就是分别封装行为接口,实现算法族,父类中放行为接口对象,在子类里具体设定行为对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       BaseDuck beiJingDuck = <span class="keyword">new</span> BeiJingDuck();</span><br><span class="line">       BaseDuck greenHeadDuck = <span class="keyword">new</span> GreenHeadDuck();</span><br><span class="line">       beiJingDuck.display();</span><br><span class="line">       greenHeadDuck.fly();</span><br><span class="line">       beiJingDuck.display();</span><br><span class="line">       greenHeadDuck.fly();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-优点-2"><a href="#6-优点-2" class="headerlink" title="6.优点"></a>6.优点</h2><ul>
<li>开闭原则</li>
<li>避免使用多重条件转移语句</li>
<li>提高算法的保密性和安全性</li>
</ul>
<h2 id="7-缺点-2"><a href="#7-缺点-2" class="headerlink" title="7.缺点"></a>7.缺点</h2><ul>
<li>客户端必须知道所有的策略类,并自行决定使用哪一个策略类</li>
<li>产生很多策略类</li>
</ul>
<p></p><h1 align="center">设计模式（十七）– 解释器模式</h1><p></p>
<p><hr></p>
<blockquote>
<p>源代码<br><a href="https://github.com/hydznsqk/MyDesignPattern" target="_blank" rel="noopener">GitHub源代码</a></p>
</blockquote>
<h2 id="1-本文目标-3"><a href="#1-本文目标-3" class="headerlink" title="1.本文目标"></a>1.本文目标</h2><p>本文目标是为了让大家认识并理解解释器模式</p>
<h2 id="2-基本套路-3"><a href="#2-基本套路-3" class="headerlink" title="2.基本套路"></a>2.基本套路</h2><p>定义:给定一个语言,定义它的文法的一种表示,并定义一个解释器,这个解释器使用该表示来解释语言中的句子</p>
<p>类型:行为型</p>
<p>选择关键点:被频繁使用的语言是否可用文法表示</p>
<p>设计原则:遵循单一职责</p>
<p>使用概率:0.00009%</p>
<p>难度系数:中</p>
<h2 id="3-适用场景-3"><a href="#3-适用场景-3" class="headerlink" title="3.适用场景"></a>3.适用场景</h2><p>1.某个特定类型问题发生频率足够高</p>
<h2 id="4-使用步骤-3"><a href="#4-使用步骤-3" class="headerlink" title="4.使用步骤"></a>4.使用步骤</h2><p>用栗子能更好的说明问题,请继续往下看</p>
<h2 id="5-举个栗子-3"><a href="#5-举个栗子-3" class="headerlink" title="5.举个栗子"></a>5.举个栗子</h2><p>我们用具体的代码去更好的理解这个设计模式</p>
<h4 id="5-1栗子说明-3"><a href="#5-1栗子说明-3" class="headerlink" title="5.1栗子说明"></a>5.1栗子说明</h4><ul>
<li>背景:输入一个字符串,通过自定义解释器,去得到一个结果</li>
<li>目的:用解释器模式自定义</li>
</ul>
<h4 id="5-2使用步骤-3"><a href="#5-2使用步骤-3" class="headerlink" title="5.2使用步骤"></a>5.2使用步骤</h4><p>实现代码如下:</p>
<p><strong>步骤1.</strong>创建解释器接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Interpreter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">interpret</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤2.</strong>创建加法解释器 实现解释器接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AddInterpreter</span> <span class="keyword">implements</span> <span class="title">Interpreter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Interpreter firstExpression, secondExpression;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AddInterpreter</span><span class="params">(Interpreter firstExpression, Interpreter secondExpression)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.firstExpression = firstExpression;</span><br><span class="line">        <span class="keyword">this</span>.secondExpression = secondExpression;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.firstExpression.interpret() + <span class="keyword">this</span>.secondExpression.interpret();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"+"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤3.</strong>创建乘法解释器 实现解释器接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MultiInterpreter</span> <span class="keyword">implements</span> <span class="title">Interpreter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Interpreter firstExpression,secondExpression;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MultiInterpreter</span><span class="params">(Interpreter firstExpression, Interpreter secondExpression)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.firstExpression=firstExpression;</span><br><span class="line">        <span class="keyword">this</span>.secondExpression=secondExpression;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.firstExpression.interpret()*<span class="keyword">this</span>.secondExpression.interpret();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"*"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤4.</strong> 创建数字解释器 实现解释器接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NumberInterpreter</span> <span class="keyword">implements</span> <span class="title">Interpreter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> number;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NumberInterpreter</span><span class="params">(<span class="keyword">int</span> number)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.number = number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NumberInterpreter</span><span class="params">(String number)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.number = Integer.parseInt(number);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.number;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤5.</strong> 创建工具类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OperatorUtil</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isOperator</span><span class="params">(String symbol)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (symbol.equals(<span class="string">"+"</span>) || symbol.equals(<span class="string">"*"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Interpreter <span class="title">getExpressionObject</span><span class="params">(Interpreter firstExpression, Interpreter secondExpression, String symbol)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (symbol.equals(<span class="string">"+"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> AddInterpreter(firstExpression, secondExpression);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (symbol.equals(<span class="string">"*"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> MultiInterpreter(firstExpression, secondExpression);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤6.</strong> 创建自定义解释器,去解释字符串</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyExpressionParser</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Stack&lt;Interpreter&gt; stack = <span class="keyword">new</span> Stack&lt;Interpreter&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">parse</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        String[] strItemArray = str.split(<span class="string">" "</span>);</span><br><span class="line">        <span class="keyword">for</span> (String symbol : strItemArray) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!OperatorUtil.isOperator(symbol)) &#123;</span><br><span class="line">                Interpreter numberExpression = <span class="keyword">new</span> NumberInterpreter(symbol);</span><br><span class="line">                stack.push(numberExpression);</span><br><span class="line">                System.out.println(String.format(<span class="string">"入栈: %d"</span>, numberExpression.interpret()));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//是运算符号，可以计算</span></span><br><span class="line">                Interpreter firstExpression = stack.pop();</span><br><span class="line">                Interpreter secondExpression = stack.pop();</span><br><span class="line">                System.out.println(String.format(<span class="string">"出栈: %d 和 %d"</span>,</span><br><span class="line">                        firstExpression.interpret(), secondExpression.interpret()));</span><br><span class="line">                Interpreter operator = OperatorUtil.getExpressionObject(firstExpression, secondExpression, symbol);</span><br><span class="line">                System.out.println(String.format(<span class="string">"应用运算符: %s"</span>, operator));</span><br><span class="line">                <span class="keyword">int</span> result = operator.interpret();</span><br><span class="line">                NumberInterpreter resultExpression = <span class="keyword">new</span> NumberInterpreter(result);</span><br><span class="line">                stack.push(resultExpression);</span><br><span class="line">                System.out.println(String.format(<span class="string">"阶段结果入栈: %d"</span>, resultExpression.interpret()));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> result = stack.pop().interpret();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤7.</strong> 测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       <span class="comment">//输入字符串,自己定义的一套算法</span></span><br><span class="line">       String geelyInputStr=<span class="string">"6 100 11 + *"</span>;</span><br><span class="line">       MyExpressionParser expressionParser=<span class="keyword">new</span> MyExpressionParser();</span><br><span class="line">       <span class="keyword">int</span> result=expressionParser.parse(geelyInputStr);</span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * 结果:</span></span><br><span class="line"><span class="comment">        * 100+11=111 111*6=666</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       System.out.println(<span class="string">"解释器计算结果: "</span>+result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-优点-3"><a href="#6-优点-3" class="headerlink" title="6.优点"></a>6.优点</h2><ul>
<li>语法由很多类表示,容易改变和扩展此”语言”</li>
</ul>
<h2 id="7-缺点-3"><a href="#7-缺点-3" class="headerlink" title="7.缺点"></a>7.缺点</h2><ul>
<li>当语法规则数目太多时,增加了系统复杂度</li>
</ul>
<p></p><h1 align="center">设计模式（十八）– 观察者模式</h1><p></p>
<hr>

<blockquote>
<p>源代码<br><a href="https://github.com/hydznsqk/MyDesignPattern" target="_blank" rel="noopener">GitHub源代码</a></p>
</blockquote>
<h2 id="1-本文目标-4"><a href="#1-本文目标-4" class="headerlink" title="1.本文目标"></a>1.本文目标</h2><p>本文目标是为了让大家认识并理解观察者模式</p>
<h2 id="2-基本套路-4"><a href="#2-基本套路-4" class="headerlink" title="2.基本套路"></a>2.基本套路</h2><p>定义:定义了对象之间的一对多依赖,让多个观察者对象同时监听某一个主题对象,当主题对象发生变化时,它的所有观察者都会收到通知并更新</p>
<p>类型:行为型</p>
<p>选择关键点:观察者与被观察者是否是多对一的关系</p>
<p>设计原则:遵循迪米特、开闭原则</p>
<p>使用概率:40%</p>
<p>难度系数:中</p>
<h2 id="3-适用场景-4"><a href="#3-适用场景-4" class="headerlink" title="3.适用场景"></a>3.适用场景</h2><p>1.关联行为场景,建立一套触发机制</p>
<h2 id="4-使用步骤-4"><a href="#4-使用步骤-4" class="headerlink" title="4.使用步骤"></a>4.使用步骤</h2><p>用栗子能更好的说明问题,请继续往下看</p>
<h2 id="5-举个栗子-4"><a href="#5-举个栗子-4" class="headerlink" title="5.举个栗子"></a>5.举个栗子</h2><p>我们用具体的代码去更好的理解这个设计模式</p>
<h4 id="5-1栗子说明-4"><a href="#5-1栗子说明-4" class="headerlink" title="5.1栗子说明"></a>5.1栗子说明</h4><ul>
<li>背景:我有好几个女朋友,一直观察着我,我去夜店观察我,去泡吧也观察我</li>
<li>目的:用观察者模式模拟女朋友观察我,然后我是被观察者,我去干什么事儿都主动通知女朋友们</li>
</ul>
<h4 id="5-2使用步骤-4"><a href="#5-2使用步骤-4" class="headerlink" title="5.2使用步骤"></a>5.2使用步骤</h4><p>实现代码如下:</p>
<p><strong>步骤1.</strong>创建观察者,女朋友们 是观察者</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(String state)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤2.</strong>创建我的其中一个女朋友,观察者的一个子类 实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GirlFriendObserver</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">GirlFriendObserver</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(String state)</span> </span>&#123;</span><br><span class="line">		System.out.println(name + <span class="string">"接到最新消息,男朋友最新状态:"</span> + state);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤3.</strong>创建被观察者 ,我自己</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Observable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> ArrayList&lt;Observer&gt; observers = <span class="keyword">new</span> ArrayList&lt;Observer&gt;();</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 添加一个观察者</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">		observers.add(observer);</span><br><span class="line">		System.out.println(<span class="string">"我新交了一个女朋友"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *去掉一个观察者 </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dettch</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">		observers.remove(observer);</span><br><span class="line">		System.out.println(<span class="string">"我和她分手了"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 通知观察者(就是通知我的女朋友们)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notyfyObservers</span><span class="params">(String state)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (Observer observer : observers) &#123;</span><br><span class="line">			observer.update(state);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤4.</strong> 创建被观察者的 子类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessageObservable</span> <span class="keyword">extends</span> <span class="title">Observable</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">change</span><span class="params">(String state)</span> </span>&#123;</span><br><span class="line">		notyfyObservers(state);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤5.</strong> 测试,女朋友是观察者,我是被观察者,现实中是观察者一直观察被观察者,如果我去泡吧了,直接分手。在代码中,是被观察者主动告诉观察者,我去泡吧了或者大保健了,然后分手。这样可以减少资源的不必要的浪费,提高性能</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       <span class="comment">//创建2个观察者</span></span><br><span class="line">       Observer fanbingbing = <span class="keyword">new</span> GirlFriendObserver(<span class="string">"范冰冰"</span>);</span><br><span class="line">       Observer yangmi = <span class="keyword">new</span> GirlFriendObserver(<span class="string">"杨幂"</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//创建被观察者</span></span><br><span class="line">       MessageObservable messageSubject = <span class="keyword">new</span> MessageObservable();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//被观察者 添加 观察者 到集合中</span></span><br><span class="line">       messageSubject.attach(fanbingbing);</span><br><span class="line">       messageSubject.attach(yangmi);</span><br><span class="line">       <span class="comment">//被观察者 通知 观察者,我都干了什么</span></span><br><span class="line">       messageSubject.change(<span class="string">"我在大保健"</span>);</span><br><span class="line"></span><br><span class="line">       messageSubject.dettch(yangmi);</span><br><span class="line">       messageSubject.notyfyObservers(<span class="string">"泡吧"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-优点-4"><a href="#6-优点-4" class="headerlink" title="6.优点"></a>6.优点</h2><ul>
<li>观察者和被观察者之间建立一个抽象的耦合</li>
<li>观察者模式支持广播通信 </li>
</ul>
<h2 id="7-缺点-4"><a href="#7-缺点-4" class="headerlink" title="7.缺点"></a>7.缺点</h2><ul>
<li>观察者之间有过多的细节依赖,提高时间消耗和程序复杂度</li>
<li>使用要得当,要避免循环调用</li>
</ul>
<p></p><h1 align="center">设计模式（十九）– 备忘录模式</h1><p></p>
<p><hr></p>
<blockquote>
<p>源代码<br><a href="https://github.com/hydznsqk/MyDesignPattern" target="_blank" rel="noopener">GitHub源代码</a></p>
</blockquote>
<h2 id="1-本文目标-5"><a href="#1-本文目标-5" class="headerlink" title="1.本文目标"></a>1.本文目标</h2><p>本文目标是为了让大家认识并理解备忘录模式</p>
<h2 id="2-基本套路-5"><a href="#2-基本套路-5" class="headerlink" title="2.基本套路"></a>2.基本套路</h2><p>定义:保存某个对象的某个状态,以便于在适当的时候恢复对象</p>
<p>类型:行为型</p>
<p>选择关键点:是否可以在必要的时候捕捉到对象的内部状态</p>
<p>设计原则:遵循迪米特、开闭原则</p>
<p>使用概率:5%</p>
<p>难度系数:中</p>
<h2 id="3-适用场景-5"><a href="#3-适用场景-5" class="headerlink" title="3.适用场景"></a>3.适用场景</h2><p>1.保存和恢复数据相关业务场景</p>
<p>2.后悔的时候,即想恢复到之前的状态</p>
<h2 id="4-使用步骤-5"><a href="#4-使用步骤-5" class="headerlink" title="4.使用步骤"></a>4.使用步骤</h2><p>用栗子能更好的说明问题,请继续往下看</p>
<h2 id="5-举个栗子-5"><a href="#5-举个栗子-5" class="headerlink" title="5.举个栗子"></a>5.举个栗子</h2><p>我们用具体的代码去更好的理解这个设计模式</p>
<h4 id="5-1栗子说明-5"><a href="#5-1栗子说明-5" class="headerlink" title="5.1栗子说明"></a>5.1栗子说明</h4><ul>
<li>背景:学习的时候会记录自己的思路,然后会记下来,如果想修改,可以恢复到之前保存的状态</li>
<li>目的:用备忘录模式模拟实现</li>
</ul>
<h4 id="5-2使用步骤-5"><a href="#5-2使用步骤-5" class="headerlink" title="5.2使用步骤"></a>5.2使用步骤</h4><p>实现代码如下:</p>
<p><strong>步骤1.</strong>创建手记</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Article</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">    <span class="keyword">private</span> String imgs;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Article</span><span class="params">(String title, String content, String imgs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.title = title;</span><br><span class="line">        <span class="keyword">this</span>.content = content;</span><br><span class="line">        <span class="keyword">this</span>.imgs = imgs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTitle</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.title = title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContent</span><span class="params">(String content)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getImgs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> imgs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setImgs</span><span class="params">(String imgs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.imgs = imgs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存到备忘录中</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArticleMemento <span class="title">saveToMemento</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ArticleMemento articleMemento = <span class="keyword">new</span> ArticleMemento(<span class="keyword">this</span>.title, <span class="keyword">this</span>.content, <span class="keyword">this</span>.imgs);</span><br><span class="line">        <span class="keyword">return</span> articleMemento;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undoFromMemento</span><span class="params">(ArticleMemento articleMemento)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.title = articleMemento.getTitle();</span><br><span class="line">        <span class="keyword">this</span>.content = articleMemento.getContent();</span><br><span class="line">        <span class="keyword">this</span>.imgs = articleMemento.getImgs();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Article&#123;"</span> +</span><br><span class="line">                <span class="string">"title='"</span> + title + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", content='"</span> + content + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", imgs='"</span> + imgs + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤2.</strong>创建手记备忘</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleMemento</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">    <span class="keyword">private</span> String imgs;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArticleMemento</span><span class="params">(String title, String content, String imgs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.title = title;</span><br><span class="line">        <span class="keyword">this</span>.content = content;</span><br><span class="line">        <span class="keyword">this</span>.imgs = imgs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getImgs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> imgs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"ArticleMemento&#123;"</span> +</span><br><span class="line">                <span class="string">"title='"</span> + title + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", content='"</span> + content + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", imgs='"</span> + imgs + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤3.</strong>创建手记备忘管理者</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleMementoManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Stack&lt;ArticleMemento&gt; ARTICLE_MEMENTO_STACK = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArticleMemento <span class="title">getMemento</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ArticleMemento articleMemento = ARTICLE_MEMENTO_STACK.pop();</span><br><span class="line">        <span class="keyword">return</span> articleMemento;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addMemento</span><span class="params">(ArticleMemento articleMemento)</span> </span>&#123;</span><br><span class="line">        ARTICLE_MEMENTO_STACK.push(articleMemento);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤4.</strong> 测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       ArticleMementoManager articleMementoManager = <span class="keyword">new</span> ArticleMementoManager();</span><br><span class="line"></span><br><span class="line">       Article article = <span class="keyword">new</span> Article(<span class="string">"如影随行的设计模式A"</span>, <span class="string">"手记内容A"</span>, <span class="string">"手记图片A"</span>);</span><br><span class="line">       ArticleMemento articleMemento = article.saveToMemento();</span><br><span class="line">       articleMementoManager.addMemento(articleMemento);</span><br><span class="line">       System.out.println(<span class="string">"标题:"</span> + article.getTitle() + <span class="string">" 内容:"</span> + article.getContent() + <span class="string">" 图片:"</span> + article.getImgs() + <span class="string">" 暂存成功"</span>);</span><br><span class="line">       System.out.println(<span class="string">"手记完整信息:"</span> + article);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"修改手记start"</span>);</span><br><span class="line"></span><br><span class="line">       article.setTitle(<span class="string">"如影随行的设计模式B"</span>);</span><br><span class="line">       article.setContent(<span class="string">"手记内容B"</span>);</span><br><span class="line">       article.setImgs(<span class="string">"手记图片B"</span>);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"修改手记end"</span>);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"手记完整信息:"</span> + article);</span><br><span class="line"></span><br><span class="line">       articleMemento = article.saveToMemento();</span><br><span class="line">       articleMementoManager.addMemento(articleMemento);</span><br><span class="line"></span><br><span class="line">       article.setTitle(<span class="string">"如影随行的设计模式C"</span>);</span><br><span class="line">       article.setContent(<span class="string">"手记内容C"</span>);</span><br><span class="line">       article.setImgs(<span class="string">"手记图片C"</span>);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"暂存回退start"</span>);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"回退出栈1次"</span>);</span><br><span class="line">       articleMemento = articleMementoManager.getMemento();</span><br><span class="line">       article.undoFromMemento(articleMemento);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"回退出栈2次"</span>);</span><br><span class="line">       articleMemento = articleMementoManager.getMemento();</span><br><span class="line">       article.undoFromMemento(articleMemento);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"暂存回退end"</span>);</span><br><span class="line">       System.out.println(<span class="string">"手记完整信息:"</span> + article);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-优点-5"><a href="#6-优点-5" class="headerlink" title="6.优点"></a>6.优点</h2><ul>
<li>为用户提供了一种可恢复的机制</li>
<li>存档信息的封装</li>
</ul>
<h2 id="7-缺点-5"><a href="#7-缺点-5" class="headerlink" title="7.缺点"></a>7.缺点</h2><ul>
<li>资源占用</li>
</ul>
<p></p><h1 align="center">设计模式（二十）– 命令模式</h1><p></p>
<hr>

<blockquote>
<p>源代码<br><a href="https://github.com/hydznsqk/MyDesignPattern" target="_blank" rel="noopener">GitHub源代码</a></p>
</blockquote>
<h2 id="1-本文目标-6"><a href="#1-本文目标-6" class="headerlink" title="1.本文目标"></a>1.本文目标</h2><p>本文目标是为了让大家认识并理解命令模式</p>
<h2 id="2-基本套路-6"><a href="#2-基本套路-6" class="headerlink" title="2.基本套路"></a>2.基本套路</h2><p>定义:将请求封装成对象,以便使用不同的请求</p>
<p>类型:行为型</p>
<p>选择关键点:请求者是否不需要关心命令的执行只知道接受者</p>
<p>设计原则:遵循迪米特、开闭原则</p>
<p>使用概率:20%</p>
<p>难度系数:中高</p>
<h2 id="3-适用场景-6"><a href="#3-适用场景-6" class="headerlink" title="3.适用场景"></a>3.适用场景</h2><p>1.请求的调用者和请求接受者需要解耦,使得调用者和接受者不直接交互</p>
<p>2.需要抽象出等待执行的行为</p>
<h2 id="4-使用步骤-6"><a href="#4-使用步骤-6" class="headerlink" title="4.使用步骤"></a>4.使用步骤</h2><p>用栗子能更好的说明问题,请继续往下看</p>
<h2 id="5-举个栗子-6"><a href="#5-举个栗子-6" class="headerlink" title="5.举个栗子"></a>5.举个栗子</h2><p>我们用具体的代码去更好的理解这个设计模式</p>
<h4 id="5-1栗子说明-6"><a href="#5-1栗子说明-6" class="headerlink" title="5.1栗子说明"></a>5.1栗子说明</h4><ul>
<li>背景:网站上课程是有视频的,免费打开视频让大家看或者关闭这个视频收费才能看</li>
<li>目的:用命令模式模拟</li>
</ul>
<h4 id="5-2使用步骤-6"><a href="#5-2使用步骤-6" class="headerlink" title="5.2使用步骤"></a>5.2使用步骤</h4><p>实现代码如下:</p>
<p><strong>步骤1.</strong>创建命令接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤2.</strong>创建课程视频</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CourseVideo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CourseVideo</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.name+<span class="string">"课程视频开放"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.name+<span class="string">"课程视频关闭"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤3.</strong>创建打开课程视频命令和关闭课程视频命令</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OpenCourseVideoCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> CourseVideo courseVideo;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OpenCourseVideoCommand</span><span class="params">(CourseVideo courseVideo)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courseVideo = courseVideo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        courseVideo.open();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CloseCourseVideoCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> CourseVideo courseVideo;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CloseCourseVideoCommand</span><span class="params">(CourseVideo courseVideo)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courseVideo = courseVideo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        courseVideo.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤4.</strong> 创建工作人员类可以执行一组命令</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Staff</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Command&gt; commandList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCommand</span><span class="params">(Command command)</span></span>&#123;</span><br><span class="line">        commandList.add(command);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">executeCommands</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(Command command : commandList)&#123;</span><br><span class="line">            command.execute();</span><br><span class="line">        &#125;</span><br><span class="line">        commandList.clear();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤5.</strong> 测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       <span class="comment">//创建课程</span></span><br><span class="line">       CourseVideo courseVideo = <span class="keyword">new</span> CourseVideo(<span class="string">"Java设计模式"</span>);</span><br><span class="line">       <span class="comment">//创建打开命令</span></span><br><span class="line">       OpenCourseVideoCommand openCourseVideoCommand = <span class="keyword">new</span> OpenCourseVideoCommand(courseVideo);</span><br><span class="line">       <span class="comment">//创建关闭命令</span></span><br><span class="line">       CloseCourseVideoCommand closeCourseVideoCommand = <span class="keyword">new</span> CloseCourseVideoCommand(courseVideo);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//创建工作人员</span></span><br><span class="line">       Staff staff = <span class="keyword">new</span> Staff();</span><br><span class="line">       staff.addCommand(openCourseVideoCommand);</span><br><span class="line">       staff.addCommand(closeCourseVideoCommand);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//执行这一组命令</span></span><br><span class="line">       staff.executeCommands();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-优点-6"><a href="#6-优点-6" class="headerlink" title="6.优点"></a>6.优点</h2><ul>
<li>降低耦合</li>
<li>容易扩展新命令或者一组命令</li>
</ul>
<h2 id="7-缺点-6"><a href="#7-缺点-6" class="headerlink" title="7.缺点"></a>7.缺点</h2><ul>
<li>命令的无限扩展会增加类的数量,提高系统的实现复杂度</li>
</ul>
<p></p><h1 align="center">设计模式（二一）– 中介者模式</h1><p></p>
<hr>

<blockquote>
<p>源代码<br><a href="https://github.com/hydznsqk/MyDesignPattern" target="_blank" rel="noopener">GitHub源代码</a></p>
</blockquote>
<h2 id="1-本文目标-7"><a href="#1-本文目标-7" class="headerlink" title="1.本文目标"></a>1.本文目标</h2><p>本文目标是为了让大家认识并理解中介者模式</p>
<h2 id="2-基本套路-7"><a href="#2-基本套路-7" class="headerlink" title="2.基本套路"></a>2.基本套路</h2><p>定义:定义一个封装一组对象如何交互的对象</p>
<p>类型:行为型</p>
<p>选择关键点:复杂的交互关系是否有共性可被中介者承担</p>
<p>设计原则:遵循迪米特，破坏单一职责</p>
<p>使用概率:10%</p>
<p>难度系数:中</p>
<h2 id="3-适用场景-7"><a href="#3-适用场景-7" class="headerlink" title="3.适用场景"></a>3.适用场景</h2><p>1.系统中对象之间存在复杂的引用关系,产生的相互依赖关系结构混乱且难以理解</p>
<p>2.交互的公共行为,如果需要改变行为则可以增加新的中介者类</p>
<h2 id="4-使用步骤-7"><a href="#4-使用步骤-7" class="headerlink" title="4.使用步骤"></a>4.使用步骤</h2><p>用栗子能更好的说明问题,请继续往下看</p>
<h2 id="5-举个栗子-7"><a href="#5-举个栗子-7" class="headerlink" title="5.举个栗子"></a>5.举个栗子</h2><p>我们用具体的代码去更好的理解这个设计模式</p>
<h4 id="5-1栗子说明-7"><a href="#5-1栗子说明-7" class="headerlink" title="5.1栗子说明"></a>5.1栗子说明</h4><ul>
<li>背景:风清扬和令狐冲交流,传授独孤九剑</li>
<li>目的:用中介者模式模拟</li>
</ul>
<h4 id="5-2使用步骤-7"><a href="#5-2使用步骤-7" class="headerlink" title="5.2使用步骤"></a>5.2使用步骤</h4><p>实现代码如下:</p>
<p><strong>步骤1.</strong>创建中介者,可以理解为一个群,大家都可以在这里面说话</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudyGroup</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">showMessage</span><span class="params">(User user, String message)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">new</span> Date().toString() + <span class="string">" ["</span> + user.getName() + <span class="string">"] : "</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤2.</strong>创建用户User</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 交给中介者展示信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        StudyGroup.showMessage(<span class="keyword">this</span>, message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤3.</strong> 测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       User fengqingyang = <span class="keyword">new</span> User(<span class="string">"风清扬"</span>);</span><br><span class="line">       User linghuchong = <span class="keyword">new</span> User(<span class="string">"令狐冲"</span>);</span><br><span class="line"></span><br><span class="line">       fengqingyang.sendMessage(<span class="string">"传授你独孤九剑"</span>);</span><br><span class="line">       linghuchong.sendMessage(<span class="string">"OK"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-优点-7"><a href="#6-优点-7" class="headerlink" title="6.优点"></a>6.优点</h2><ul>
<li>将一对多转化成了一对一,降低程序复杂度</li>
<li>类之间解耦</li>
</ul>
<h2 id="7-缺点-7"><a href="#7-缺点-7" class="headerlink" title="7.缺点"></a>7.缺点</h2><ul>
<li>中介者过多,导致系统复杂</li>
</ul>
<p></p><h1 align="center">设计模式（二二）– 责任链模式</h1><p></p>
<p><hr></p>
<blockquote>
<p>源代码<br><a href="https://github.com/hydznsqk/MyDesignPattern" target="_blank" rel="noopener">GitHub源代码</a></p>
</blockquote>
<h2 id="1-本文目标-8"><a href="#1-本文目标-8" class="headerlink" title="1.本文目标"></a>1.本文目标</h2><p>本文目标是为了让大家认识并理解责任链模式</p>
<h2 id="2-基本套路-8"><a href="#2-基本套路-8" class="headerlink" title="2.基本套路"></a>2.基本套路</h2><p>定义:为请求创建一个接受此次请求对象的链</p>
<p>类型:行为型</p>
<p>选择关键点:对于每一次请求是否每个处理的对象都需要一次处理机会</p>
<p>设计原则:遵循迪米特</p>
<p>使用概率:15%</p>
<p>难度系数:中</p>
<h2 id="3-适用场景-8"><a href="#3-适用场景-8" class="headerlink" title="3.适用场景"></a>3.适用场景</h2><p>1.一个请求的处理需要多个对象当中的一个或几个协作处理</p>
<h2 id="4-使用步骤-8"><a href="#4-使用步骤-8" class="headerlink" title="4.使用步骤"></a>4.使用步骤</h2><p>用栗子能更好的说明问题,请继续往下看</p>
<h2 id="5-举个栗子-8"><a href="#5-举个栗子-8" class="headerlink" title="5.举个栗子"></a>5.举个栗子</h2><p>我们用具体的代码去更好的理解这个设计模式</p>
<h4 id="5-1栗子说明-8"><a href="#5-1栗子说明-8" class="headerlink" title="5.1栗子说明"></a>5.1栗子说明</h4><ul>
<li>背景:在网站上发布一个课程,需要两个人检查,一个是视频,一个是手记</li>
<li>目的:用责任链模式模</li>
</ul>
<h4 id="5-2使用步骤-8"><a href="#5-2使用步骤-8" class="headerlink" title="5.2使用步骤"></a>5.2使用步骤</h4><p>实现代码如下:</p>
<p><strong>步骤1.</strong>创建课程类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Course</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String article;</span><br><span class="line">    <span class="keyword">private</span> String video;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getArticle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> article;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setArticle</span><span class="params">(String article)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.article = article;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getVideo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> video;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVideo</span><span class="params">(String video)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.video = video;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Course&#123;"</span> +</span><br><span class="line">                <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", article='"</span> + article + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", video='"</span> + video + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤2.</strong>创建抽象的批准者类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Approver</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> Approver approver;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNextApprover</span><span class="params">(Approver approver)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.approver = approver;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">deploy</span><span class="params">(Course course)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤3.</strong> 创建手记批准者和视频批准者</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleApprover</span> <span class="keyword">extends</span> <span class="title">Approver</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deploy</span><span class="params">(Course course)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotEmpty(course.getArticle())) &#123;</span><br><span class="line">            System.out.println(course.getName() + <span class="string">"含有手记,批准"</span>);</span><br><span class="line">            <span class="keyword">if</span> (approver != <span class="keyword">null</span>) &#123;</span><br><span class="line">                approver.deploy(course);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(course.getName() + <span class="string">"不含有手记,不批准,流程结束"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VideoApprover</span> <span class="keyword">extends</span> <span class="title">Approver</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deploy</span><span class="params">(Course course)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotEmpty(course.getVideo())) &#123;</span><br><span class="line">            System.out.println(course.getName() + <span class="string">"含有视频,批准"</span>);</span><br><span class="line">            <span class="keyword">if</span> (approver != <span class="keyword">null</span>) &#123;</span><br><span class="line">                approver.deploy(course);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(course.getName() + <span class="string">"不含有视频,不批准,流程结束"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤4.</strong> 测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       <span class="comment">//创建手记批准者</span></span><br><span class="line">       Approver articleApprover = <span class="keyword">new</span> ArticleApprover();</span><br><span class="line">       <span class="comment">//创建视频批准者</span></span><br><span class="line">       Approver videoApprover = <span class="keyword">new</span> VideoApprover();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//创建课程</span></span><br><span class="line">       Course course = <span class="keyword">new</span> Course();</span><br><span class="line">       course.setName(<span class="string">"Java设计模式精讲"</span>);</span><br><span class="line">       course.setArticle(<span class="string">"Java设计模式精讲的手记"</span>);</span><br><span class="line">       course.setVideo(<span class="string">"Java设计模式精讲的视频"</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//校验</span></span><br><span class="line">       articleApprover.setNextApprover(videoApprover);</span><br><span class="line">       articleApprover.deploy(course);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-优点-8"><a href="#6-优点-8" class="headerlink" title="6.优点"></a>6.优点</h2><ul>
<li>请求的发送者和接受者(请求的处理者)解耦</li>
<li>责任链可以动态组合</li>
</ul>
<h2 id="7-缺点-8"><a href="#7-缺点-8" class="headerlink" title="7.缺点"></a>7.缺点</h2><ul>
<li>责任链太长或者处理时间过长,影响性能</li>
<li>责任链有可能过多</li>
</ul>
<p></p><h1 align="center">设计模式（二三）– 访问者模式</h1><p></p>
<p><hr></p>
<blockquote>
<p>源代码<br><a href="https://github.com/hydznsqk/MyDesignPattern" target="_blank" rel="noopener">GitHub源代码</a></p>
</blockquote>
<h2 id="1-本文目标-9"><a href="#1-本文目标-9" class="headerlink" title="1.本文目标"></a>1.本文目标</h2><p>本文目标是为了让大家认识并理解访问者模式</p>
<h2 id="2-基本套路-9"><a href="#2-基本套路-9" class="headerlink" title="2.基本套路"></a>2.基本套路</h2><p>定义:封装作用于某数据结构(比如List,Set,Map等)中的个元素的操作</p>
<p>类型:行为型</p>
<p>选择关键点:数据结构是否稳定以及操作是否经常变化</p>
<p>设计原则:遵循倾斜的开闭原则</p>
<p>使用概率:5%</p>
<p>难度系数:高</p>
<h2 id="3-适用场景-9"><a href="#3-适用场景-9" class="headerlink" title="3.适用场景"></a>3.适用场景</h2><p>1.一个数据结构如(List/Set/Map等)包含很多类型对象</p>
<p>2.数据结构与数据操作分类</p>
<h2 id="4-使用步骤-9"><a href="#4-使用步骤-9" class="headerlink" title="4.使用步骤"></a>4.使用步骤</h2><p>用栗子能更好的说明问题,请继续往下看</p>
<h2 id="5-举个栗子-9"><a href="#5-举个栗子-9" class="headerlink" title="5.举个栗子"></a>5.举个栗子</h2><p>我们用具体的代码去更好的理解这个设计模式</p>
<h4 id="5-1栗子说明-9"><a href="#5-1栗子说明-9" class="headerlink" title="5.1栗子说明"></a>5.1栗子说明</h4><ul>
<li>背景:网站上有免费课程和付费课程</li>
<li>目的:用访问者模式模拟</li>
</ul>
<h4 id="5-2使用步骤-9"><a href="#5-2使用步骤-9" class="headerlink" title="5.2使用步骤"></a>5.2使用步骤</h4><p>实现代码如下:</p>
<p><strong>步骤1.</strong>创建课程类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Course</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//是否接受访问</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(IVisitor visitor)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤2.</strong>创建Visitor 接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IVisitor</span> </span>&#123;</span><br><span class="line">    <span class="comment">//访问免费课程</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(FreeCourse freeCourse)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//访问付费课程</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(CodingCourse codingCourse)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤3.</strong> 创建免费课程和代码付费课程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FreeCourse</span> <span class="keyword">extends</span> <span class="title">Course</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(IVisitor visitor)</span> </span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CodingCourse</span> <span class="keyword">extends</span> <span class="title">Course</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> price;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">int</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(IVisitor visitor)</span> </span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤4.</strong> 创建Visitor的实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Visitor</span> <span class="keyword">implements</span> <span class="title">IVisitor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//访问免费课程，打印所有免费课程名称</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(FreeCourse freeCourse)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"免费课程:"</span>+freeCourse.getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//访问付费课程，打印所有实战课程名称及价格</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(CodingCourse codingCourse)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"付费课程:"</span>+codingCourse.getName()+<span class="string">" 价格:"</span>+codingCourse.getPrice()+<span class="string">"元"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤5.</strong> 测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       List&lt;Course&gt; courseList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//免费课程</span></span><br><span class="line">       FreeCourse freeCourse = <span class="keyword">new</span> FreeCourse();</span><br><span class="line">       freeCourse.setName(<span class="string">"Android基础"</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//付费课程</span></span><br><span class="line">       CodingCourse codingCourse = <span class="keyword">new</span> CodingCourse();</span><br><span class="line">       codingCourse.setName(<span class="string">"Java设计模式精讲"</span>);</span><br><span class="line">       codingCourse.setPrice(<span class="number">299</span>);</span><br><span class="line"></span><br><span class="line">       courseList.add(freeCourse);</span><br><span class="line">       courseList.add(codingCourse);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">for</span> (Course course : courseList) &#123;</span><br><span class="line">           course.accept(<span class="keyword">new</span> Visitor());</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-优点-9"><a href="#6-优点-9" class="headerlink" title="6.优点"></a>6.优点</h2><ul>
<li>增加新的操作很容易,就是增加一个新的访问者</li>
</ul>
<h2 id="7-缺点-9"><a href="#7-缺点-9" class="headerlink" title="7.缺点"></a>7.缺点</h2><ul>
<li>增加新的数据结构困难</li>
<li>具体元素变更比较麻烦</li>
</ul>
<p></p><h1 align="center">设计模式（二四）– 状态模式</h1><p></p>
<hr>

<blockquote>
<p>源代码<br><a href="https://github.com/hydznsqk/MyDesignPattern" target="_blank" rel="noopener">GitHub源代码</a></p>
</blockquote>
<h2 id="1-本文目标-10"><a href="#1-本文目标-10" class="headerlink" title="1.本文目标"></a>1.本文目标</h2><p>本文目标是为了让大家认识并理解状态模式</p>
<h2 id="2-基本套路-10"><a href="#2-基本套路-10" class="headerlink" title="2.基本套路"></a>2.基本套路</h2><p>定义:当一个对象的内在状态改变时允许改变其行为，这个对象看起来像是改变了其类。</p>
<p>类型:行为型</p>
<p>选择关键点:这些状态是否经常在运行时需要在不同的动态之间相互转换</p>
<p>设计原则:遵循单一职责、依赖倒置、开闭原则</p>
<p>使用概率:20%</p>
<p>难度系数: 中</p>
<h2 id="3-适用场景-10"><a href="#3-适用场景-10" class="headerlink" title="3.适用场景"></a>3.适用场景</h2><p>1.一个对象在多个状态下行为不同，且这些状态可互相转换</p>
<h2 id="4-使用步骤-10"><a href="#4-使用步骤-10" class="headerlink" title="4.使用步骤"></a>4.使用步骤</h2><p>用栗子能更好的说明问题,请继续往下看</p>
<h2 id="5-举个栗子-10"><a href="#5-举个栗子-10" class="headerlink" title="5.举个栗子"></a>5.举个栗子</h2><p>我们用具体的代码去更好的理解这个设计模式</p>
<h4 id="5-1栗子说明-10"><a href="#5-1栗子说明-10" class="headerlink" title="5.1栗子说明"></a>5.1栗子说明</h4><ul>
<li>背景:播放一个课程,有多种状态,播放,暂停,快进,停止</li>
<li>目的:用状态模式模拟</li>
</ul>
<h4 id="5-2使用步骤-10"><a href="#5-2使用步骤-10" class="headerlink" title="5.2使用步骤"></a>5.2使用步骤</h4><p>实现代码如下:</p>
<p><strong>步骤1.</strong>创建课程视频状态  抽象类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CourseVideoState</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> CourseVideoContext courseVideoContext;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourseVideoContext</span><span class="params">(CourseVideoContext courseVideoContext)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courseVideoContext = courseVideoContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">speed</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">pause</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤2.</strong>创建播放,暂停,快进,停止等状态类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PlayState</span> <span class="keyword">extends</span> <span class="title">CourseVideoState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"正常播放课程视频状态"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">speed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.SPEED_STATE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.PAUSE_STATE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.STOP_STATE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PauseState</span> <span class="keyword">extends</span> <span class="title">CourseVideoState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.PLAY_STATE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">speed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.SPEED_STATE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"暂停播放课程视频状态"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.STOP_STATE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpeedState</span> <span class="keyword">extends</span> <span class="title">CourseVideoState</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.PLAY_STATE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">speed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"快进播放课程视频状态"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.PAUSE_STATE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.STOP_STATE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StopState</span> <span class="keyword">extends</span> <span class="title">CourseVideoState</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.PLAY_STATE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">speed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ERROR 停止状态不能快进!!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ERROR 停止状态不能暂停!!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"停止播放课程视频状态"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤3.</strong> 创建课程视频内容管理类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CourseVideoContext</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> CourseVideoState courseVideoState;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> PlayState PLAY_STATE = <span class="keyword">new</span> PlayState();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> StopState STOP_STATE = <span class="keyword">new</span> StopState();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> PauseState PAUSE_STATE = <span class="keyword">new</span> PauseState();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> SpeedState SPEED_STATE = <span class="keyword">new</span> SpeedState();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CourseVideoState <span class="title">getCourseVideoState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> courseVideoState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourseVideoState</span><span class="params">(CourseVideoState courseVideoState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courseVideoState = courseVideoState;</span><br><span class="line">        <span class="keyword">this</span>.courseVideoState.setCourseVideoContext(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courseVideoState.play();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">speed</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courseVideoState.speed();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courseVideoState.stop();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pause</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courseVideoState.pause();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>步骤4.</strong> 测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       CourseVideoContext courseVideoContext = <span class="keyword">new</span> CourseVideoContext();</span><br><span class="line">       courseVideoContext.setCourseVideoState(<span class="keyword">new</span> PlayState());</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"当前状态:"</span>+courseVideoContext.getCourseVideoState().getClass().getSimpleName());</span><br><span class="line">       courseVideoContext.pause();</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"当前状态:"</span>+courseVideoContext.getCourseVideoState().getClass().getSimpleName());</span><br><span class="line">       courseVideoContext.speed();</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"当前状态:"</span>+courseVideoContext.getCourseVideoState().getClass().getSimpleName());</span><br><span class="line">       courseVideoContext.stop();</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"当前状态:"</span>+courseVideoContext.getCourseVideoState().getClass().getSimpleName());</span><br><span class="line">       courseVideoContext.speed();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-优点-10"><a href="#6-优点-10" class="headerlink" title="6.优点"></a>6.优点</h2><ul>
<li>状态模式将与特定状态相关的行为局部化，并且将不同状态的行为分割开来</li>
<li>所有状态相关的代码都存在于某个ConcereteState中，所以通过定义新的子类很容易地增加新的状态和转换</li>
<li>状态模式通过把各种状态转移逻辑分不到State的子类之间，来减少相互间的依赖</li>
</ul>
<h2 id="7-缺点-10"><a href="#7-缺点-10" class="headerlink" title="7.缺点"></a>7.缺点</h2><ul>
<li>导致较多的ConcreteState子类</li>
</ul>
<p>#总结<br>本文只是对所有行为型模式的分享,接下来会继续分享其他Android干货,大家可以持续进行关注,<a href="https://www.jianshu.com/u/f07649312c75" target="_blank" rel="noopener">信仰年輕的设计模式</a>,蟹蟹啦。</p>
</div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/设计模式/" class="post__tag__link">设计模式</a></li><li class="post__tag__item"><a href="/tags/Android/" class="post__tag__link">Android</a></li><li class="post__tag__item"><a href="/tags/工厂模式/" class="post__tag__link">工厂模式</a></li><li class="post__tag__item"><a href="/tags/Java/" class="post__tag__link">Java</a></li></ul></footer></article><div class="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript></div></div></main><footer class="foot"><div class="foot-copy u-fl"><span>©2018 </span><a href="https://github.com/zhufaner">Tech Team of Zhufaner Inc.</a></div><menu class="page-menu u-fr"><li class="page-menu__item"><span title="Previous" class="page-menu__link icon-arrow-left page-menu__link--disabled"></span></li><li class="page-menu__item"><a title="Next" href="/2018/12/03/设计模式系列（二）-- 结构型设计模式/" class="page-menu__link icon-arrow-right"></a></li></menu></footer><script>(function(h,g,l,k,j,i){j=h.createElement(g),i=h.getElementsByTagName(g)[0],j.src="//"+l+".disqus.com/"+k+".js",i.parentNode.insertBefore(j,i)})(document,"script","zhu-fan-er-ji-zhu-tuan-dui","embed");
</script><div style="display: none;"><script src="https://s4.cnzz.com/z_stat.php?id=1261929418&web_id=1261929418" language="JavaScript"></script></div><script src="/js/scroller.js"></script><script src="/js/main.js"></script></body></html>